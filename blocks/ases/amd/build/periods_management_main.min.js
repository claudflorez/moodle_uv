define(["jquery","block_ases/bootstrap","block_ases/jquery.dataTables","block_ases/sweetalert","block_ases/select2","block_ases/jqueryui"],function(a,b,c,d,e,f){return{init:function(){function b(b,c){var d=b;d||(d=a("#periods").val()),a.ajax({type:"POST",data:{dat:d},url:"../managers/periods_management/search_period_processing.php",success:function(b){c?c(b):b.error?(swal("Error",b.error,"error"),a(".assignment_li").addClass("hidden"),a("#periods").val("").trigger("change.select2"),a("#periods").prop("disabled",!1),a("#semester_name").val(""),a("#search_button").prop("disabled",!1)):""==b.nombre?(swal("Error","El semestre no existe en la base de datos","error"),a("#periods").prop("disabled",!1)):(a(".assignment_li").removeClass("hidden"),a("#semester_name").val(b.nombre),a("#beginning_date").val(b.fecha_inicio),a("#ending_date").val(b.fecha_fin))},dataType:"json",error:function(b){swal("Error","Hay un error con la conexión","error"),a(".assignment_li").addClass("hidden"),a("#periods").val("").trigger("change.select2"),a("#periods").prop("disabled",!1),a("#semester_name").val(" "),a("#search_button").prop("disabled",!1)}})}function c(){var b=a("#periods").val(),c=a("#semester_name").val(),d=a("#beginning_date").val(),e=a("#ending_date").val(),g=f(b,c,d,e);"success"!=g?swal({title:"Advertencia",text:g,type:"warning",html:!0}):a.ajax({type:"POST",data:{id:b,name:c,beginning:d,ending:e},url:"../managers/periods_management/update_period_processing.php",success:function(a){swal({title:"Información",text:a,type:"info",html:!0,confirmButtonColor:"#d51b23",confirmButtonText:"OK",closeOnConfirm:!0})},dataType:"text",cache:"false",error:function(a){swal("Error","Ha ocurrido un error","error")}})}function d(){a.ajax({type:"POST",data:{load:"loadSemester"},url:"../managers/periods_management/load_periods_processing.php",success:function(b){a("#div_periods").empty(),a("#div_periods").append('<table id="tablePeriods" class="display" cellspacing="0" width="100%"><thead><thead></table>');a("#tablePeriods").DataTable(b);a("#div_periods").css("cursor","pointer")},dataType:"json",cache:!1,error:function(a){alert("Error al cargar períodos")}})}function e(){var b=a("#new_semester_name").val(),c=a("#new_beginning_date").val(),d=a("#new_ending_date").val(),e=g(b,c,d);"success"!=e?swal({title:"Advertencia",text:e,type:"warning",html:!0}):a.ajax({type:"POST",data:{op:"createSemester",name:b,beginning:c,ending:d},url:"../managers/periods_management/create_period_processing.php",success:function(a){swal({title:"Información",text:a,type:"info",html:!0,confirmButtonColor:"#d51b23",confirmButtonText:"OK",closeOnConfirm:!0})},dataType:"text",cache:"false",error:function(a){swal("Error","Ha ocurrido un error","error")}})}function f(a,b,c,d){var e=/^\d{4}\-(0?[1-9]|1[012])\-(0?[1-9]|[12][0-9]|3[01])$/,f=e.exec(c),g=e.exec(d);return""==b&&""==c&&""==d?"Debe llenar todos los campos":""==c||""==d?"Debe introducir la fecha de inicio y fin del período":null===f?"La fecha de inicio no sigue el patrón yyyy-mm-dd. Ejemplo: 2017-10-20":null===g?"La fecha de fin no sigue el patrón yyyy-mm-dd. Ejemplo: 2017-10-20":c==d?"La fecha de inicio y de fin deben ser diferentes":""==a?"Se encontró un problema con el identificador del semestre, vuelva a seleccionar el semestre":""==b?"Debe ingresar el nombre del semestre":"success"}function g(a,b,c){var d=/^\d{4}\-(0?[1-9]|1[012])\-(0?[1-9]|[12][0-9]|3[01])$/,e=d.exec(b),f=d.exec(c);return""==a&&""==b&&""==c?"Debe llenar todos los campos":""==b||""==c?"Debe introducir la fecha de inicio y fin del período":null===e?"La fecha de inicio no sigue el patrón yyyy-mm-dd. Ejemplo: 2017-10-20":null===f?"La fecha de fin no sigue el patrón yyyy-mm-dd. Ejemplo: 2017-10-20":b==c?"La fecha de inicio y de fin deben ser diferentes":""==a?"Debe ingresar el nombre del semestre":"success"}a("#periods").select2({language:{noResults:function(){return"No se encontraron resultados"},searching:function(){return"Buscando..."}},dropDownAutoWidth:!0}),a(document).ready(function(){a(".assignment_li").css({display:"none"}),a(".period_date").datepicker({dateFormat:"yy-mm-dd"}),a("#search_button").on("click",function(){a("#search_button").prop("disabled",!0),b(),a("#periods").prop("disabled",!0),a(".assignment_li").slideToggle("fast")}),a("#ok-button").on("click",function(){c(),a(".assignment_li").addClass("hidden"),a("#periods").val("").trigger("change.select2"),a("#periods").prop("disabled",!1),a("#search_button").prop("disabled",!1),a("#semester_name").val(" "),a("#beginning_date").val(" "),a("#ending_date").val(" ")}),a("#cancel-button").on("click",function(){a(".assignment_li").addClass("hidden"),a("#periods").val("").trigger("change.select2"),a("#periods").prop("disabled",!1),a("#search_button").prop("disabled",!1),a("#semester_name").val(" "),a("#beginning_date").val(" "),a("#ending_date").val(" ")}),a("#save-button").on("click",function(){e(),a("#new_semester_name").val(" "),a("#new_beginning_date").val(" "),a("#new_ending_date").val(" ")}),a("#cancel-save-button").on("click",function(){a("#new_semester_name").val(" "),a("#new_beginning_date").val(" "),a("#new_ending_date").val(" ")}),a("#list-periods-panel").on("click",function(){d()})})}}});